<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Array Questions Part 2 &mdash; Elements of Leetcode 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Knowledge Base Math" href="../math/math_kb.html" />
    <link rel="prev" title="Array Questions Part 1" href="array_1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Elements of Leetcode
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Bit Manipulation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_kb.html">Knowledge base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_1.html">Part 1 (1-9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_2.html">Part 2 (10-19)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_3.html">Part 3 (20-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_4.html">Part 4 (30-36)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Array:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="array_kb.html">Knowledge base</a></li>
<li class="toctree-l1"><a class="reference internal" href="array_1.html">Part 1 (37-45)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Part 2 (46-55)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lc-280-computing-an-alternation">46. (LC 280)  Computing an alternation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-204-enumerate-all-primes-to-n">47. (LC 204) Enumerate all primes to n</a></li>
<li class="toctree-l2"><a class="reference internal" href="#permute-the-elements-of-an-array">48. Permute the elements of an array</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-31-compute-the-next-permutation">49. (LC 31) Compute the next permutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-offline-data">50. Sample offline data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-online-data">51. Sample online data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-384-compute-a-random-permutation">52. (LC 384) Compute a random permutation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Math:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../math/math_kb.html">Knowledge base</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About the Project:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Elements of Leetcode</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Array Questions Part 2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/array/array_2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="array-questions-part-2">
<h1>Array Questions Part 2<a class="headerlink" href="#array-questions-part-2" title="Link to this heading"></a></h1>
<section id="lc-280-computing-an-alternation">
<h2>46. (LC 280)  Computing an alternation<a class="headerlink" href="#lc-280-computing-an-alternation" title="Link to this heading"></a></h2>
<p>LC 280. Wiggle Sort</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution to Leetcode</span>
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">wiggleSort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do not return anything, modify nums in-place instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p><em>Task</em> [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>].
Write a program that takes an array A of n numbers, and rearranges A’s elements to get a new array
B having the property that B[0] &lt;= B[1] &gt;= B[2] &lt;= B[3] &gt;= B[4] &lt; B[5] &gt;=….</p>
<div class="line-block">
<div class="line">(I.e. There is an interleaving:</div>
<div class="line">n less than neighbors, n greater than neighbors, n less than neighbors etc)</div>
<div class="line">Example.</div>
<div class="line">A = [2,1,5,7,8]</div>
<div class="line">B = [1,5,2,8,7] #5 greater than adjacents, 2 smaller, 8 greater</div>
</div>
<div class="line-block">
<div class="line"># Key to solution</div>
<div class="line">Alternate sorting in direct and reverse order (based on whether index is odd ot even).</div>
</div>
<div class="line-block">
<div class="line"># The straightforward solutions, O(N log N)</div>
<div class="line">1) to sort A and interleave the bottom and top halves of the sorted array.</div>
<div class="line">2) sort A and then swap the elements at the pairs (A[1],A[2]),(A[3],A[4]),….</div>
<div class="line">Both these approaches have the same time complexity as sorting, namely O(n log n).</div>
</div>
<p>3) But it is not necessary to sort A to achieve the desired configuration -
you could simply rearrange the elements around the median, and then perform the
interleaving.
Median finding can be performed in time O(n), which is the overall time complexity of this approach.</p>
<p><em>Logic</em>, O (N).
You may notice that the desired ordering is very local, and it is not necessary
to find the median. Iterating through the array and swapping A[i] and A[i + 1]
when i is even and A[i] &gt; A[i+1] or i is odd and A[i] &lt; A[i + 1] achieves the desired configuration.</p>
<div class="line-block">
<div class="line">This approach has the same time complexity as the median finding (O(N)), but it is [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>]:</div>
<div class="line">- easier to implement,</div>
<div class="line">- never needs to store more than two elements in memory or read a previous element.</div>
<div class="line">- illustrates algorithm design by iterative refinement of a brute-force solution.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="k">def</span> <span class="nf">rearrange</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">i</span><span class="o">%</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">### Solution my V (less magic)</span>
<span class="k">def</span> <span class="nf">alternation</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>


<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>   <span class="c1"># [2, 1, 7, 5, 8]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alternation</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">rearrange</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># [1, 5, 2, 8, 7]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Explained</strong> (main version)</div>
<div class="line"><em>Main aspects</em></div>
<div class="line">1)A[i:i+2] - is a slice of 2 numbers in A</div>
<div class="line">A = [2,1,5,7,8] =&gt; 2,1; 1,5; 5,7 etc</div>
<div class="line">2)sorted(A[i:i+2]) - is sorting this slice of 2 numbers</div>
<div class="line">3)reverse=i% 2 - sets reverse to True or False</div>
</div>
<p>(when i is even, the remainder = 0, setting reverse to False. When i is odd,
any value of the remainder will set reverse to True)</p>
<div class="line-block">
<div class="line">The main principle - we make sure when</div>
<div class="line">i=even A[i] &gt; A[i+1] (sorted)</div>
<div class="line">i=odd, A[i] &lt; A[i+1] (reverse sorted)</div>
<div class="line">Hence achieve the interleaving.</div>
</div>
</section>
<section id="lc-204-enumerate-all-primes-to-n">
<h2>47. (LC 204) Enumerate all primes to n<a class="headerlink" href="#lc-204-enumerate-all-primes-to-n" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">204. Count Primes</div>
<div class="line">(Medium)</div>
<div class="line">Here the task is to return a list of the primes [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>].</div>
</div>
<p>A natural number is called a prime if it is bigger than 1 and has no divisors
other than 1 and itself.
Write a program that takes an integer argument and returns all the primes
between 1 and that integer.
For example, if the input is 18, you should return &lt;2,3,5,7,11,13,17&gt;.</p>
<div class="line-block">
<div class="line"><strong>Square root approach</strong></div>
<div class="line">An improved brute force is to iterate through all numbers and do ‘trial division’,</div>
<div class="line">dividing each integer from 2 to the square root of i+1.</div>
</div>
<p>For the rule is - since if i has a divisor other than 1 and itself, it must also
have a divisor that is no greater than its square root.</p>
<div class="line-block">
<div class="line"><em>Complexity</em></div>
<div class="line">Each test has time O(sqroot n),</div>
<div class="line">the entire computation time is O(n * sqroot n), i.e. O (n ** 3/2)</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1">#Don&#39;t forget +1</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c1">#[2, 3, 5, 7]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Sieving approach</strong></div>
<div class="line"><em>Complexity</em></div>
<div class="line">O(n log log n)</div>
<div class="line">Sieving is superior to trial-division.</div>
</div>
<div class="line-block">
<div class="line"><em>Basic Logic</em></div>
<div class="line">We exclude the multiples of primes. (Because multiples of primes cannot be primes themselves.)</div>
</div>
<p>When a number is identified as prime, we sieve it, i.e. remove all its multiples
from future consideration.
We use a Boolean array to encode the candidates. E.g. [F,F,T,T,T,T]. We can set
the first two to false because 0 and 1 are not primes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution (sieving)</span>
<span class="c1"># Given n, return all primes up to and including n.</span>
<span class="k">def</span> <span class="nf">generate_primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># is_prime[p] represents if p is prime or not. Initially, set each to</span>
    <span class="c1"># true, expecting 0 and 1. Then use sieving to eliminate nonprimes.</span>
    <span class="n">is_prime</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_prime</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>        <span class="c1">#enter only if value at index p is True</span>
            <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>   <span class="c1">#append num 2</span>
            <span class="c1"># Sieve p&#39;s multiples.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>  <span class="c1">#use step, range 3rd param</span>
                <span class="n">is_prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">primes</span>

<span class="c1"># no comments</span>
<span class="k">def</span> <span class="nf">generate_primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">is_prime</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_prime</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>
            <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
                <span class="n">is_prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">primes</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_primes</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>  <span class="c1">#[2, 3, 5, 7, 11]</span>
</pre></div>
</div>
</section>
<section id="permute-the-elements-of-an-array">
<h2>48. Permute the elements of an array<a class="headerlink" href="#permute-the-elements-of-an-array" title="Link to this heading"></a></h2>
<p>A permutation is a rearrangement of members of a sequence into a new sequence.
A permutation can be specified by an array P, where P[i] represents the location
of the element.</p>
<div class="line-block">
<div class="line">E.g. A = [‘a’,’b’,’c’,’d’]</div>
<div class="line">perm = [2,0,1,3]</div>
<div class="line">This maps:</div>
<div class="line">a,b,c,d</div>
<div class="line">2,0,1,3 (map ‘a’ to i=2)</div>
<div class="line">b,c,a,d</div>
</div>
<div class="line-block">
<div class="line"><em>Task</em></div>
<div class="line">Given an array A of n elements and a permutation P, apply P to A.</div>
</div>
<div class="line-block">
<div class="line">Hint: Any permutation can be viewed as a set of cyclic permutations.</div>
<div class="line">For an element in a cycle, how would you identify if it has been permuted?</div>
</div>
<div class="line-block">
<div class="line"><em>time and space O(n)</em></div>
<div class="line">When using an additional array to write the resulting array.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### My V2</span>
<span class="k">def</span> <span class="nf">perm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>  <span class="c1">#[&#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;d&#39;]</span>

<span class="c1">### My version, using dict to mark permuted elements</span>
<span class="k">def</span> <span class="nf">permute</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">index</span><span class="p">]],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]</span>
<span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">permute</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">perm</span><span class="p">))</span> <span class="c1">#[&#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;d&#39;]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><em>O(n) time, O(1) space</em></div>
<div class="line">We don’t use an additional array, we change A in place.</div>
</div>
<p>Independent cyclic permutations: We keep going forward from i to P[i] till we get
back to i.
After we are done with that cycle, we need to find another cycle that has not yet
been applied. It can be done by storing a Boolean for each array element.
But another way (that will give us O(n1) space) is to use the sign bit
in the entries in the permutation-array. Specifically, we subtract n from P[i] after applying it. This
means that if an entry in P[i] is negative, we have performed the corresponding move.</p>
<div class="line-block">
<div class="line"><strong>Solution</strong></div>
<div class="line">Key: subtract len of p from p[i] to mark permuted items.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_permutation</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">i</span>
        <span class="c1"># Check if perm[i] is nonnegative (i.e. check if the element at index i</span>
        <span class="c1"># has not been moved</span>
        <span class="k">while</span> <span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span>
            <span class="c1"># Subtracts len(perm) from an entry in perm to make it negative,</span>
            <span class="c1"># which indicates the corresponding move has been performed.</span>
            <span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
            <span class="nb">next</span> <span class="o">=</span> <span class="n">temp</span>
    <span class="c1"># Restore perm.</span>
    <span class="n">perm</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">perm</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">apply_permutation</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1">#[&#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;d&#39;]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"># In the loop</div>
<div class="line">1)</div>
<div class="line">i=0</div>
<div class="line">next=0</div>
<div class="line">A = [c,b,a,d]</div>
<div class="line">perm = [-2,0,1,3]</div>
<div class="line">next = 2</div>
<div class="line">2)</div>
<div class="line">i=0 still</div>
<div class="line">next=2</div>
<div class="line">A = [b,c,a,d]</div>
<div class="line">perm = [-2,0,-3,3]</div>
<div class="line">next=1</div>
</div>
<p>(Though we already got our aimed at permuted array, we will go on for some time
with the loop. Then return to the main i loop, but that will finish quickly as
our values in perm get negative, and while loop works only for positives.)</p>
</section>
<section id="lc-31-compute-the-next-permutation">
<h2>49. (LC 31) Compute the next permutation<a class="headerlink" href="#lc-31-compute-the-next-permutation" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">31. <a class="reference external" href="https://leetcode.com/problems/next-permutation/">Next Permutation</a></div>
<div class="line">Medium</div>
</div>
<p>(dictionary ordering)</p>
<div class="line-block">
<div class="line"><a class="reference external" href="https://docs.python.org/3/library/itertools.html#itertools.permutations" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">itertools.permutations()</span></code></a></div>
<div class="line">itertools.permutations(iterable, r=None)</div>
<div class="line">Return successive r length permutations of elements in the iterable.</div>
</div>
<p>If r is not specified or is None, then r defaults to the length of the iterable
and all possible full-length permutations are generated.</p>
<p>If the input iterable is sorted, the output tuples will be produced in sorted order.</p>
<p>Elements are treated as unique based on their position, not on their value.
So if the input elements are unique, there will be no repeated values within a permutation.</p>
<p>Roughly it means:
# permutations(‘ABCD’, 2) –&gt; AB AC AD BA BC BD CA CB CD DA DB DC
# permutations(range(3)) –&gt; 012 021 102 120 201 210</p>
<p>Exactly it means:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">&lt;itertools.permutations object at 0x7fa8b147a1b0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[(&#39;A&#39;, &#39;B&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;D&#39;), (&#39;B&#39;, &#39;A&#39;), (&#39;B&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;A&#39;),</span>
<span class="go">(&#39;C&#39;, &#39;B&#39;), (&#39;C&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;A&#39;), (&#39;D&#39;, &#39;B&#39;), (&#39;D&#39;, &#39;C&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
<span class="go">(&#39;A&#39;, &#39;B&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
<span class="go">(&#39;A&#39;, &#39;C&#39;)</span>
</pre></div>
</div>
</section>
<section id="sample-offline-data">
<h2>50. Sample offline data<a class="headerlink" href="#sample-offline-data" title="Link to this heading"></a></h2>
<p>Implement an algorithm that takes as input an array of elements and returns
a subset of the given size of the array elements. All subsets should be equally
likely. Return the result in input array itself.</p>
<p># Practical applications -
To select a random subset of customers to test a new UI (see if it increases
the visit duration) before rolling out the change.</p>
<div class="line-block">
<div class="line"># Implementation</div>
<div class="line">A = [3,7,5,11], k=3 where k is the size of a new array, i.e. the limit.</div>
<div class="line">We use the random number generator to pick a random integer in the interval [0, len(A)-1].</div>
<div class="line">It is going to be a random index in our original array.</div>
<div class="line">E.g. randint(0,3) returns 2. It means we now swap A[0] with A[2].</div>
<div class="line">(Note, 3 is not k, it is len(A)-1 -&gt; 4-1. Also 2 is the index in A.)</div>
<div class="line">Now A = [5,7,3,11]</div>
<div class="line">Then we do randint(1,3). Etc.</div>
<div class="line">(Left bound moves +1 towards the len of A. We make k number of such random picks.)</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_sampling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>   <span class="c1">#k is size of the new array</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="c1"># Generate a random index in [i, len(A) - 1].</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="c1"># OR</span>
    <span class="c1"># index = random.randrange(i, len(a))</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_sampling</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">A</span><span class="p">))</span> <span class="c1">#example output [7, 11, 5]</span>
</pre></div>
</div>
<p># My note -
Since we use the stdlib module random anyway,
why not use the dedicated .sample(list, sample_size)
<code class="docutils literal notranslate"><span class="pre">print(random.sample(A,</span> <span class="pre">3))</span> <span class="pre">#[5,</span> <span class="pre">3,</span> <span class="pre">11]</span></code></p>
</section>
<section id="sample-online-data">
<h2>51. Sample online data<a class="headerlink" href="#sample-online-data" title="Link to this heading"></a></h2>
<p>(In practice it can be to provide a uniform sample of packets for a network session.)</p>
<p><em>Task</em> [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>] -
Given input A size n, write a program that reads input A maintaining a uniform random
subset of size k.</p>
<div class="line-block">
<div class="line"># Brute force</div>
<div class="line">Read all packets</div>
<div class="line">[…], […], […], […]</div>
<div class="line">choose randomly using solution 5.12</div>
<div class="line">k=2</div>
<div class="line">[..1.], […], […2], […]</div>
<div class="line">Space O(n), time O(nk)</div>
</div>
<div class="line-block">
<div class="line"># Space O(k), time proportional to the number of elements in the stream.</div>
<div class="line">Example.</div>
<div class="line">k=2, packets p,q,r,t,u,v</div>
<div class="line">For our first subset we just take the first two packets {p, q}.</div>
<div class="line">Selecting the next packet.</div>
<div class="line">1)r will be selected with probability k/(n+1), here 2/3 (where n starts at 0).</div>
<div class="line">Suppose it is not selected.</div>
<div class="line">2) t suppose it is selected (probability 2/4)</div>
<div class="line">Then we replace one of the previously chosen packets with t.</div>
<div class="line">E.g. we end up with {p,t}.</div>
<div class="line">3) etc.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### V0 my</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_subset1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="c1">### V2 my</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_subset2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>  <span class="c1">#generate random index</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="c1">### V1 My version (don&#39;t know if we can use it here)</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_subset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">swap_i</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">swap_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">swap_i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_subset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1">#2 runs, OUT:[1, 3, 2], [4, 2, 5]</span>
</pre></div>
</div>
<div class="admonition-itertools-islice-iterable-stop admonition">
<p class="admonition-title">itertools.islice(iterable, stop)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;itertools.islice object at 0x7fa8b0b5c540&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;]</span>
</pre></div>
</div>
</div>
<p><strong>Solution</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span><span class="o">,</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">online_random_sample</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">sampling_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">num_seen_so_far</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">num_seen_so_far</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">idx_to_replace</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">num_seen_so_far</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx_to_replace</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">sampling_results</span><span class="p">[</span><span class="n">idx_to_replace</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">sampling_results</span>

<span class="n">it</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;pqrtuv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">online_random_sample</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># 3 calls produce random results: [&#39;v&#39;, &#39;q&#39;], [&#39;v&#39;, &#39;p&#39;], [&#39;p&#39;, &#39;q&#39;]</span>

<span class="c1"># With comments</span>
<span class="k">def</span> <span class="nf">online_random_sample</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="c1"># Gets us first result [p, q] (slice input data[0:2])</span>
    <span class="n">sampling_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

    <span class="c1"># Start sampling starting at index 2, before that is our initial sample</span>
    <span class="n">num_seen_so_far</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">num_seen_so_far</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1">#2+1=3</span>
        <span class="c1"># In the first loop, choose random index out of 0,1,2.</span>
        <span class="c1"># As range() randrange() stops before the given number.</span>
        <span class="n">idx_to_replace</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">num_seen_so_far</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx_to_replace</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>                     <span class="c1">#**</span>
            <span class="n">sampling_results</span><span class="p">[</span><span class="n">idx_to_replace</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">sampling_results</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">#** This is tricky</div>
<div class="line">if idx_to_replace &lt; k:</div>
<div class="line">In the first loop index can be 0,1,2. Our k=2</div>
<div class="line">If index=2, it means we do not choose element, i.e. here ‘r’.</div>
<div class="line">If index is 0 or 1, we replace the so far [p,q] at index 0 or 1,</div>
<div class="line">e.g. if index 0, we will have [r,q]</div>
</div>
</section>
<section id="lc-384-compute-a-random-permutation">
<h2>52. (LC 384) Compute a random permutation<a class="headerlink" href="#lc-384-compute-a-random-permutation" title="Link to this heading"></a></h2>
<p>384. <a class="reference external" href="https://leetcode.com/problems/shuffle-an-array/">Shuffle an Array</a> -
Medium</p>
<p>Design an algorithm that creates uniformly random permutations of {0, 1,…,n - 1}.</p>
<p><strong>Notes</strong>:
Generating random permutations with equal probability is not as straightforward
as it seems.
Iterating and swapping each element with another randomly does not generate all
permutations with equal probability.
E.g. when there are n=3 elements. The number of permutations is 3! = 6.
Ways to choose elements to swap is 3**3 = 27.
Since 27 is not divisible by 6, some permutations correspond to more ways than others.</p>
<div class="line-block">
<div class="line"><strong>Key points</strong>:</div>
<div class="line">-Store the result in original array A that we make out of list(range(n))</div>
<div class="line">-Our algorithm should make sure that we don’t pick an element that has already been picked, i.e. pick only from the remaining.</div>
<div class="line">E.g. n=4, thus A = [0,1,2,3].</div>
</div>
<p>1)First random number is chosen between index 0 and index 3. We get e.g. index to
update with=1, we swap current index 0 with index 1. Get A=[1,0,2,3].</p>
<p>2)Next choose from indices 1-3, e.g. random choice gives us index 3, swap i=1 with
index=3. A=[1,3,0,2] etc.</p>
<p>We iterate through A and swap current index with a randomly generated index from
only the remaining indices.
This reminds of the function we used earlier. We are going to use it as a helper
function for the current solution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_sampling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>   <span class="c1">#k is size of the new array</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">#r is random index</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">compute_random_permutation</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">permutation</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">random_sampling</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">permutation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">permutation</span>

<span class="nb">print</span><span class="p">(</span><span class="n">compute_random_permutation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># OUT</span>
<span class="c1"># [2, 3, 0, 4, 1]</span>
<span class="c1"># [0, 3, 2, 4, 1]</span>

<span class="c1">### V1 my</span>
<span class="c1"># The main point - choose a random index from len of array.</span>
<span class="c1"># Swap current index with random index.</span>
<span class="c1"># Diminish indices to randomly choose from by 1 (or len - current index)</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_permut</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">le</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">le</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">le</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="nb">print</span><span class="p">(</span><span class="n">random_permut</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># [1, 0, 2, 3, 5, 4], run2 [2, 5, 3, 1, 4, 0]</span>

<span class="c1">### V2 my</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">shuffle_array2</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="c1">### FYI. Python stdlib tools</span>
<span class="c1">#1</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">shuffle_array</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
<p>#2</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
<span class="go">(0, 1, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
<span class="go">(0, 1, 3, 2)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="array_1.html" class="btn btn-neutral float-left" title="Array Questions Part 1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../math/math_kb.html" class="btn btn-neutral float-right" title="Knowledge Base Math" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Veronika Kirichenko.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>