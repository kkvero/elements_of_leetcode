<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Array Questions Part 2 &mdash; Elements of Leetcode 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Array Questions Part 3" href="array_3.html" />
    <link rel="prev" title="Array Questions Part 1" href="array_1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Elements of Leetcode
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Bit Manipulation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_kb.html">Knowledge base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_1.html">Part 1 (1-9)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_2.html">Part 2 (10-19)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_3.html">Part 3 (20-29)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bits/bits_4.html">Part 4 (30-36)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Array:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="array_kb.html">Knowledge base</a></li>
<li class="toctree-l1"><a class="reference internal" href="array_1.html">Part 1 (37-45)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Part 2 (46-55)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lc-280-computing-an-alternation">46. (LC 280)  Computing an alternation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-204-enumerate-all-primes-to-n">47. (LC 204) Enumerate all primes to n</a></li>
<li class="toctree-l2"><a class="reference internal" href="#permute-the-elements-of-an-array">48. Permute the elements of an array</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-31-compute-the-next-permutation">49. (LC 31) Compute the next permutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-offline-data">50. Sample offline data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-online-data">51. Sample online data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-384-compute-a-random-permutation">52. (LC 384) Compute a random permutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-nonuniform-random-numbers">53. Generate nonuniform random numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-36-valid-sudoku">54. (LC 36) Valid Sudoku</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lc-118-compute-rows-in-pascal-s-triangle">55. (LC 118) Compute rows in Pascal’s triangle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="array_3.html">Part 3 (56-65)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Math:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../math/math_kb.html">Knowledge base</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About the Project:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Elements of Leetcode</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Array Questions Part 2</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/array/array_2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="array-questions-part-2">
<h1>Array Questions Part 2<a class="headerlink" href="#array-questions-part-2" title="Link to this heading"></a></h1>
<section id="lc-280-computing-an-alternation">
<h2>46. (LC 280)  Computing an alternation<a class="headerlink" href="#lc-280-computing-an-alternation" title="Link to this heading"></a></h2>
<p>LC 280. Wiggle Sort</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution to Leetcode</span>
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">wiggleSort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do not return anything, modify nums in-place instead.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<p><em>Task</em> [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>].
Write a program that takes an array A of n numbers, and rearranges A’s elements to get a new array
B having the property that B[0] &lt;= B[1] &gt;= B[2] &lt;= B[3] &gt;= B[4] &lt; B[5] &gt;=….</p>
<div class="line-block">
<div class="line">(I.e. There is an interleaving:</div>
<div class="line">n less than neighbors, n greater than neighbors, n less than neighbors etc)</div>
<div class="line">Example.</div>
<div class="line">A = [2,1,5,7,8]</div>
<div class="line">B = [1,5,2,8,7] #5 greater than adjacents, 2 smaller, 8 greater</div>
</div>
<div class="line-block">
<div class="line"># Key to solution</div>
<div class="line">Alternate sorting in direct and reverse order (based on whether index is odd ot even).</div>
</div>
<div class="line-block">
<div class="line"># The straightforward solutions, O(N log N)</div>
<div class="line">1) to sort A and interleave the bottom and top halves of the sorted array.</div>
<div class="line">2) sort A and then swap the elements at the pairs (A[1],A[2]),(A[3],A[4]),….</div>
<div class="line">Both these approaches have the same time complexity as sorting, namely O(n log n).</div>
</div>
<p>3) But it is not necessary to sort A to achieve the desired configuration -
you could simply rearrange the elements around the median, and then perform the
interleaving.
Median finding can be performed in time O(n), which is the overall time complexity of this approach.</p>
<p><em>Logic</em>, O (N).
You may notice that the desired ordering is very local, and it is not necessary
to find the median. Iterating through the array and swapping A[i] and A[i + 1]
when i is even and A[i] &gt; A[i+1] or i is odd and A[i] &lt; A[i + 1] achieves the desired configuration.</p>
<div class="line-block">
<div class="line">This approach has the same time complexity as the median finding (O(N)), but it is [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>]:</div>
<div class="line">- easier to implement,</div>
<div class="line">- never needs to store more than two elements in memory or read a previous element.</div>
<div class="line">- illustrates algorithm design by iterative refinement of a brute-force solution.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="k">def</span> <span class="nf">rearrange</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="n">i</span><span class="o">%</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">### Solution my V (less magic)</span>
<span class="k">def</span> <span class="nf">alternation</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>


<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>   <span class="c1"># [2, 1, 7, 5, 8]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alternation</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="n">rearrange</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># [1, 5, 2, 8, 7]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Explained</strong> (main version)</div>
<div class="line"><em>Main aspects</em></div>
<div class="line">1)A[i:i+2] - is a slice of 2 numbers in A</div>
<div class="line">A = [2,1,5,7,8] =&gt; 2,1; 1,5; 5,7 etc</div>
<div class="line">2)sorted(A[i:i+2]) - is sorting this slice of 2 numbers</div>
<div class="line">3)reverse=i% 2 - sets reverse to True or False</div>
</div>
<p>(when i is even, the remainder = 0, setting reverse to False. When i is odd,
any value of the remainder will set reverse to True)</p>
<div class="line-block">
<div class="line">The main principle - we make sure when</div>
<div class="line">i=even A[i] &gt; A[i+1] (sorted)</div>
<div class="line">i=odd, A[i] &lt; A[i+1] (reverse sorted)</div>
<div class="line">Hence achieve the interleaving.</div>
</div>
</section>
<section id="lc-204-enumerate-all-primes-to-n">
<h2>47. (LC 204) Enumerate all primes to n<a class="headerlink" href="#lc-204-enumerate-all-primes-to-n" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">204. Count Primes</div>
<div class="line">(Medium)</div>
<div class="line">Here the task is to return a list of the primes [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>].</div>
</div>
<p>A natural number is called a prime if it is bigger than 1 and has no divisors
other than 1 and itself.
Write a program that takes an integer argument and returns all the primes
between 1 and that integer.
For example, if the input is 18, you should return &lt;2,3,5,7,11,13,17&gt;.</p>
<div class="line-block">
<div class="line"><strong>Square root approach</strong></div>
<div class="line">An improved brute force is to iterate through all numbers and do ‘trial division’,</div>
<div class="line">dividing each integer from 2 to the square root of i+1.</div>
</div>
<p>For the rule is - since if i has a divisor other than 1 and itself, it must also
have a divisor that is no greater than its square root.</p>
<div class="line-block">
<div class="line"><em>Complexity</em></div>
<div class="line">Each test has time O(sqroot n),</div>
<div class="line">the entire computation time is O(n * sqroot n), i.e. O (n ** 3/2)</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1">#Don&#39;t forget +1</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="c1">#[2, 3, 5, 7]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Sieving approach</strong></div>
<div class="line"><em>Complexity</em></div>
<div class="line">O(n log log n)</div>
<div class="line">Sieving is superior to trial-division.</div>
</div>
<div class="line-block">
<div class="line"><em>Basic Logic</em></div>
<div class="line">We exclude the multiples of primes. (Because multiples of primes cannot be primes themselves.)</div>
</div>
<p>When a number is identified as prime, we sieve it, i.e. remove all its multiples
from future consideration.
We use a Boolean array to encode the candidates. E.g. [F,F,T,T,T,T]. We can set
the first two to false because 0 and 1 are not primes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution (sieving)</span>
<span class="c1"># Given n, return all primes up to and including n.</span>
<span class="k">def</span> <span class="nf">generate_primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># is_prime[p] represents if p is prime or not. Initially, set each to</span>
    <span class="c1"># true, expecting 0 and 1. Then use sieving to eliminate nonprimes.</span>
    <span class="n">is_prime</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_prime</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>        <span class="c1">#enter only if value at index p is True</span>
            <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>   <span class="c1">#append num 2</span>
            <span class="c1"># Sieve p&#39;s multiples.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>  <span class="c1">#use step, range 3rd param</span>
                <span class="n">is_prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">primes</span>

<span class="c1"># no comments</span>
<span class="k">def</span> <span class="nf">generate_primes</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">is_prime</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_prime</span><span class="p">[</span><span class="n">p</span><span class="p">]:</span>
            <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
                <span class="n">is_prime</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">primes</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_primes</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>  <span class="c1">#[2, 3, 5, 7, 11]</span>
</pre></div>
</div>
</section>
<section id="permute-the-elements-of-an-array">
<h2>48. Permute the elements of an array<a class="headerlink" href="#permute-the-elements-of-an-array" title="Link to this heading"></a></h2>
<p>A permutation is a rearrangement of members of a sequence into a new sequence.
A permutation can be specified by an array P, where P[i] represents the location
of the element.</p>
<div class="line-block">
<div class="line">E.g. A = [‘a’,’b’,’c’,’d’]</div>
<div class="line">perm = [2,0,1,3]</div>
<div class="line">This maps:</div>
<div class="line">a,b,c,d</div>
<div class="line">2,0,1,3 (map ‘a’ to i=2)</div>
<div class="line">b,c,a,d</div>
</div>
<div class="line-block">
<div class="line"><em>Task</em></div>
<div class="line">Given an array A of n elements and a permutation P, apply P to A.</div>
</div>
<div class="line-block">
<div class="line">Hint: Any permutation can be viewed as a set of cyclic permutations.</div>
<div class="line">For an element in a cycle, how would you identify if it has been permuted?</div>
</div>
<div class="line-block">
<div class="line"><em>time and space O(n)</em></div>
<div class="line">When using an additional array to write the resulting array.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### My V2</span>
<span class="k">def</span> <span class="nf">perm</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">tuple</span><span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>  <span class="c1">#[&#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;d&#39;]</span>

<span class="c1">### My version, using dict to mark permuted elements</span>
<span class="k">def</span> <span class="nf">permute</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">while</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">index</span><span class="p">]],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">]</span>
<span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">permute</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">perm</span><span class="p">))</span> <span class="c1">#[&#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;d&#39;]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><em>O(n) time, O(1) space</em></div>
<div class="line">We don’t use an additional array, we change A in place.</div>
</div>
<p>Independent cyclic permutations: We keep going forward from i to P[i] till we get
back to i.
After we are done with that cycle, we need to find another cycle that has not yet
been applied. It can be done by storing a Boolean for each array element.
But another way (that will give us O(n1) space) is to use the sign bit
in the entries in the permutation-array. Specifically, we subtract n from P[i] after applying it. This
means that if an entry in P[i] is negative, we have performed the corresponding move.</p>
<div class="line-block">
<div class="line"><strong>Solution</strong></div>
<div class="line">Key: subtract len of p from p[i] to mark permuted items.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_permutation</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)):</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">i</span>
        <span class="c1"># Check if perm[i] is nonnegative (i.e. check if the element at index i</span>
        <span class="c1"># has not been moved</span>
        <span class="k">while</span> <span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span>
            <span class="c1"># Subtracts len(perm) from an entry in perm to make it negative,</span>
            <span class="c1"># which indicates the corresponding move has been performed.</span>
            <span class="n">perm</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
            <span class="nb">next</span> <span class="o">=</span> <span class="n">temp</span>
    <span class="c1"># Restore perm.</span>
    <span class="n">perm</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">perm</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">perm</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">apply_permutation</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1">#[&#39;b&#39;, &#39;c&#39;, &#39;a&#39;, &#39;d&#39;]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"># In the loop</div>
<div class="line">1)</div>
<div class="line">i=0</div>
<div class="line">next=0</div>
<div class="line">A = [c,b,a,d]</div>
<div class="line">perm = [-2,0,1,3]</div>
<div class="line">next = 2</div>
<div class="line">2)</div>
<div class="line">i=0 still</div>
<div class="line">next=2</div>
<div class="line">A = [b,c,a,d]</div>
<div class="line">perm = [-2,0,-3,3]</div>
<div class="line">next=1</div>
</div>
<p>(Though we already got our aimed at permuted array, we will go on for some time
with the loop. Then return to the main i loop, but that will finish quickly as
our values in perm get negative, and while loop works only for positives.)</p>
</section>
<section id="lc-31-compute-the-next-permutation">
<h2>49. (LC 31) Compute the next permutation<a class="headerlink" href="#lc-31-compute-the-next-permutation" title="Link to this heading"></a></h2>
<ol class="arabic simple" start="31">
<li><p><a class="reference external" href="https://leetcode.com/problems/next-permutation/">Next Permutation</a> (Medium)</p></li>
</ol>
<div class="line-block">
<div class="line"><strong>Background</strong></div>
<div class="line"><strong>How to calculate the number of permutations</strong></div>
<div class="line">P(n,k)=n!/(n-k)!</div>
<div class="line">Where n is the number of values you have, k is the size of sample.</div>
<div class="line">If n=3, k=3, P(3,3)=3!/(3-3)!=3!/0!=3!</div>
<div class="line">FYI 0!=1 (0 is still a number, and there is only 1 way to arrange it).</div>
</div>
<div class="line-block">
<div class="line"><strong>What is the next permutation</strong></div>
<div class="line">e.g. You are given nums=[1,2,3]</div>
<div class="line">Use a decision tree (note that when having a choice, we choose the smallest num</div>
<div class="line">(for a lexicographical permutation)):</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Illustration</span>
<span class="c1">#   1      2       3</span>
<span class="c1">#  2 3    1 3    1  2</span>
<span class="c1"># 3   2  3   1  2    1</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Find the next perm of a given array</strong></div>
<div class="line"><strong>Solution</strong> [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">7</span></a>]</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
<span class="k">def</span> <span class="nf">nextPermutation</span><span class="p">(</span><span class="n">nums</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="c1"># Could add an edge case</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">nums</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># if ~i:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">j</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Short example</strong></div>
<div class="line">nums=[3,2,1]</div>
<div class="line">i=-1</div>
<div class="line">then no loop for j, just reverse nums</div>
<div class="line">nums=[1,2,3]</div>
</div>
<div class="line-block">
<div class="line"><strong>Logic</strong> [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">11, 10</span></a>]</div>
<div class="line"><strong>In words:</strong></div>
<div class="line">E.g. nums=[0,1,3,10,9,4,2,0]</div>
</div>
<p><strong>1</strong> Look for ASCENDING pattern.
Find the position of an element before the pattern changes from ascending to descending,
but in reverse, starting your search from index -2.
In nums the pattern changes at i=2, value=3.</p>
<p><strong>2</strong> E.g. if nums=[3,2,1] then i=-1, then nums are in perfect descending order, we go to step 3 right away.
if i!=-1, that is if the pattern starts somewhere ‘in the middle’ of the list,
we do one more step.
Look for a number greater than num at i, to the right of i, find the first such num.
In [0,1,3,10,9,4,2,0], i=3, the first greater num at j is 4.
To find j=4, we iterate (from end, till i, in reverse) -&gt; (range(len-1, i=2, -1))
Swap values at i and j -&gt; swap 3 and 4.
[0,1,4,10,9,3,2,0]</p>
<p><strong>3</strong> Reverse numbers between i and end of array (not including i itself):
[0,1,4,0,2,3,9,10]</p>
<div class="line-block">
<div class="line"><strong>In code:</strong></div>
<div class="line">E.g. nums=[0,1,3,10,9,4,2,0]</div>
<div class="line">Find where pattern changes.</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">next((i</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(n</span> <span class="pre">-</span> <span class="pre">2,</span> <span class="pre">-1,</span> <span class="pre">-1)</span> <span class="pre">if</span> <span class="pre">nums[i]</span> <span class="pre">&lt;</span> <span class="pre">nums[i</span> <span class="pre">+</span> <span class="pre">1]),</span> <span class="pre">-1)</span></code></div>
</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">range(n</span> <span class="pre">-</span> <span class="pre">2,</span> <span class="pre">-1,</span> <span class="pre">-1)</span></code> -&gt; from len-2, till 0-1 to include 0, step backwards -1</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">next((iterator),</span> <span class="pre">-1)</span></code> -&gt; -1 is the default.</div>
</div>
<div class="line-block">
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">~i:</span></code> OR <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">i!=-1:</span></code></div>
</div>
<div class="line">~-1 is 0, if 0==False, we don’t enter the loop (i.e. if i is anything but -1 we do one more loop for j).</div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">~</span><span class="n">i</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">~</span><span class="n">i</span> <span class="o">==</span> <span class="kc">True</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">~</span><span class="n">i</span> <span class="o">==</span> <span class="kc">False</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Solution using std lib</strong></div>
<div class="line">(Yes it will not ‘turn around’ correctly when given the last combo in list, but closer to what we might use in reality.)</div>
<div class="line"><a class="reference external" href="https://docs.python.org/3/library/itertools.html#itertools.permutations" title="(in Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">itertools.permutations()</span></code></a></div>
<div class="line">itertools.permutations(iterable, r=None)</div>
<div class="line">Return successive r length permutations of elements in the iterable.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span> <span class="k">as</span> <span class="nn">it</span>
<span class="k">def</span> <span class="nf">next_perm</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
    <span class="nb">next</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="c1"># just gives current array</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>  <span class="c1"># next call gives next permutation</span>

<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># expect [1,3,2]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">next_perm</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span> <span class="c1">#[1, 3, 2]</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># expect [1,2,3]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">next_perm</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>  <span class="c1"># [3, 1, 2] #**</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n2</span><span class="o">=</span><span class="n">permutations</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
<span class="go">[(1, 2, 3), (1, 3, 2), (2, 1, 3), (2, 3, 1), (3, 1, 2), (3, 2, 1)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">=</span><span class="n">permutations</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">[(3, 2, 1), (3, 1, 2), (2, 3, 1), (2, 1, 3), (1, 3, 2), (1, 2, 3)]</span>
</pre></div>
</div>
</section>
<section id="sample-offline-data">
<h2>50. Sample offline data<a class="headerlink" href="#sample-offline-data" title="Link to this heading"></a></h2>
<p>Implement an algorithm that takes as input an array of elements and returns
a subset of the given size of the array elements. All subsets should be equally
likely. Return the result in input array itself.</p>
<p># Practical applications -
To select a random subset of customers to test a new UI (see if it increases
the visit duration) before rolling out the change.</p>
<div class="line-block">
<div class="line"># Implementation</div>
<div class="line">A = [3,7,5,11], k=3 where k is the size of a new array, i.e. the limit.</div>
<div class="line">We use the random number generator to pick a random integer in the interval [0, len(A)-1].</div>
<div class="line">It is going to be a random index in our original array.</div>
<div class="line">E.g. randint(0,3) returns 2. It means we now swap A[0] with A[2].</div>
<div class="line">(Note, 3 is not k, it is len(A)-1 -&gt; 4-1. Also 2 is the index in A.)</div>
<div class="line">Now A = [5,7,3,11]</div>
<div class="line">Then we do randint(1,3). Etc.</div>
<div class="line">(Left bound moves +1 towards the len of A. We make k number of such random picks.)</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_sampling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>   <span class="c1">#k is size of the new array</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="c1"># Generate a random index in [i, len(A) - 1].</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="c1"># OR</span>
    <span class="c1"># index = random.randrange(i, len(a))</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_sampling</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">A</span><span class="p">))</span> <span class="c1">#example output [7, 11, 5]</span>
</pre></div>
</div>
<p># My note -
Since we use the stdlib module random anyway,
why not use the dedicated .sample(list, sample_size)
<code class="docutils literal notranslate"><span class="pre">print(random.sample(A,</span> <span class="pre">3))</span> <span class="pre">#[5,</span> <span class="pre">3,</span> <span class="pre">11]</span></code></p>
</section>
<section id="sample-online-data">
<h2>51. Sample online data<a class="headerlink" href="#sample-online-data" title="Link to this heading"></a></h2>
<p>(In practice it can be to provide a uniform sample of packets for a network session.)</p>
<p><em>Task</em> [<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>] -
Given input A size n, write a program that reads input A maintaining a uniform random
subset of size k.</p>
<div class="line-block">
<div class="line"># Brute force</div>
<div class="line">Read all packets</div>
<div class="line">[…], […], […], […]</div>
<div class="line">choose randomly using solution 5.12</div>
<div class="line">k=2</div>
<div class="line">[..1.], […], […2], […]</div>
<div class="line">Space O(n), time O(nk)</div>
</div>
<div class="line-block">
<div class="line"># Space O(k), time proportional to the number of elements in the stream.</div>
<div class="line">Example.</div>
<div class="line">k=2, packets p,q,r,t,u,v</div>
<div class="line">For our first subset we just take the first two packets {p, q}.</div>
<div class="line">Selecting the next packet.</div>
<div class="line">1)r will be selected with probability k/(n+1), here 2/3 (where n starts at 0).</div>
<div class="line">Suppose it is not selected.</div>
<div class="line">2) t suppose it is selected (probability 2/4)</div>
<div class="line">Then we replace one of the previously chosen packets with t.</div>
<div class="line">E.g. we end up with {p,t}.</div>
<div class="line">3) etc.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### V0 my</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_subset1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="c1">### V2 my</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_subset2</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>  <span class="c1">#generate random index</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="c1">### V1 My version (don&#39;t know if we can use it here)</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_subset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">swap_i</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">swap_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">swap_i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_subset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1">#2 runs, OUT:[1, 3, 2], [4, 2, 5]</span>
</pre></div>
</div>
<div class="admonition-itertools-islice-iterable-stop admonition">
<p class="admonition-title">itertools.islice(iterable, stop)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">&lt;itertools.islice object at 0x7fa8b0b5c540&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;]</span>
</pre></div>
</div>
</div>
<p><strong>Solution</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span><span class="o">,</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">online_random_sample</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">sampling_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
    <span class="n">num_seen_so_far</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">num_seen_so_far</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">idx_to_replace</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">num_seen_so_far</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx_to_replace</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">sampling_results</span><span class="p">[</span><span class="n">idx_to_replace</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">sampling_results</span>

<span class="n">it</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;pqrtuv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">online_random_sample</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># 3 calls produce random results: [&#39;v&#39;, &#39;q&#39;], [&#39;v&#39;, &#39;p&#39;], [&#39;p&#39;, &#39;q&#39;]</span>

<span class="c1"># With comments</span>
<span class="k">def</span> <span class="nf">online_random_sample</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="c1"># Gets us first result [p, q] (slice input data[0:2])</span>
    <span class="n">sampling_results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

    <span class="c1"># Start sampling starting at index 2, before that is our initial sample</span>
    <span class="n">num_seen_so_far</span> <span class="o">=</span> <span class="n">k</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
        <span class="n">num_seen_so_far</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1">#2+1=3</span>
        <span class="c1"># In the first loop, choose random index out of 0,1,2.</span>
        <span class="c1"># As range() randrange() stops before the given number.</span>
        <span class="n">idx_to_replace</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">num_seen_so_far</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx_to_replace</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">:</span>                     <span class="c1">#**</span>
            <span class="n">sampling_results</span><span class="p">[</span><span class="n">idx_to_replace</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">sampling_results</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">#** This is tricky</div>
<div class="line">if idx_to_replace &lt; k:</div>
<div class="line">In the first loop index can be 0,1,2. Our k=2</div>
<div class="line">If index=2, it means we do not choose element, i.e. here ‘r’.</div>
<div class="line">If index is 0 or 1, we replace the so far [p,q] at index 0 or 1,</div>
<div class="line">e.g. if index 0, we will have [r,q]</div>
</div>
</section>
<section id="lc-384-compute-a-random-permutation">
<h2>52. (LC 384) Compute a random permutation<a class="headerlink" href="#lc-384-compute-a-random-permutation" title="Link to this heading"></a></h2>
<p>384. <a class="reference external" href="https://leetcode.com/problems/shuffle-an-array/">Shuffle an Array</a> -
Medium</p>
<p>Design an algorithm that creates uniformly random permutations of {0, 1,…,n - 1}.</p>
<p><strong>Notes</strong>:
Generating random permutations with equal probability is not as straightforward
as it seems.
Iterating and swapping each element with another randomly does not generate all
permutations with equal probability.
E.g. when there are n=3 elements. The number of permutations is 3! = 6.
Ways to choose elements to swap is 3**3 = 27.
Since 27 is not divisible by 6, some permutations correspond to more ways than others.</p>
<div class="line-block">
<div class="line"><strong>Key points</strong>:</div>
<div class="line">-Store the result in original array A that we make out of list(range(n))</div>
<div class="line">-Our algorithm should make sure that we don’t pick an element that has already been picked, i.e. pick only from the remaining.</div>
<div class="line">E.g. n=4, thus A = [0,1,2,3].</div>
</div>
<p>1)First random number is chosen between index 0 and index 3. We get e.g. index to
update with=1, we swap current index 0 with index 1. Get A=[1,0,2,3].</p>
<p>2)Next choose from indices 1-3, e.g. random choice gives us index 3, swap i=1 with
index=3. A=[1,3,0,2] etc.</p>
<p>We iterate through A and swap current index with a randomly generated index from
only the remaining indices.
This reminds of the function we used earlier. We are going to use it as a helper
function for the current solution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_sampling</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>   <span class="c1">#k is size of the new array</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">#r is random index</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">compute_random_permutation</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">permutation</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">random_sampling</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">permutation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">permutation</span>

<span class="nb">print</span><span class="p">(</span><span class="n">compute_random_permutation</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="c1"># OUT</span>
<span class="c1"># [2, 3, 0, 4, 1]</span>
<span class="c1"># [0, 3, 2, 4, 1]</span>

<span class="c1">### V1 my</span>
<span class="c1"># The main point - choose a random index from len of array.</span>
<span class="c1"># Swap current index with random index.</span>
<span class="c1"># Diminish indices to randomly choose from by 1 (or len - current index)</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">random_permut</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">le</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">le</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">le</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="nb">print</span><span class="p">(</span><span class="n">random_permut</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># [1, 0, 2, 3, 5, 4], run2 [2, 5, 3, 1, 4, 0]</span>

<span class="c1">### V2 my</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">shuffle_array2</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">ri</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">ri</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">a</span>

<span class="c1">### FYI. Python stdlib tools</span>
<span class="c1">#1</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">shuffle_array</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
<p>#2</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
<span class="go">(0, 1, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">it</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
<span class="go">(0, 1, 3, 2)</span>
</pre></div>
</div>
</section>
<section id="generate-nonuniform-random-numbers">
<h2>53. Generate nonuniform random numbers<a class="headerlink" href="#generate-nonuniform-random-numbers" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">[<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">2</span></a>]</div>
<div class="line"># In essence</div>
<div class="line">We are given probabilities of occurrence of some numbers.</div>
<div class="line">Create a nonuniform random number generator.</div>
<div class="line">(Before we randomly generated numbers that could occur with equal probability.</div>
<div class="line">Well here each number can occur with a different probability.</div>
<div class="line">E.g. 7 with P=0.5, 9 with P=0.2 etc.)</div>
</div>
<p># Practical application -
Load test for a server. You have the inter-arrival time of requests to the server
over a period of one year. You have a histogram of the distribution of the arrival
times of requests. In the load test you would like to simulate data arriving at the
same time as the distribution observed historically.</p>
<div class="line-block">
<div class="line"># Example</div>
<div class="line">You are given n numbers and probabilities p0,p1,…,Pn-1, which sum up to 1.</div>
<div class="line">E.g. we have:</div>
<div class="line">values = [3,5,7,11] # i.e. 3 packets arrived etc. I suppose</div>
<div class="line">probabilities = [9/18, 6/18, 2/18, 1/18]</div>
<div class="line">(Then in 1000 000 calls to your program, 3 should appear about 500 000 times, 5 - 333 333 times.)</div>
</div>
<div class="line-block">
<div class="line"># Python stdlib tools we will use here</div>
<div class="line">1) itertools.accumulate([1,2,3,4,5]) –&gt; 1 3 6 10 15</div>
<div class="line">2) &gt;&gt;&gt; random.random()</div>
<div class="line">0.5787888523695183 # generates a random number between 0 and 1</div>
<div class="line">3) bisect.bisect(A, x), returns an insertion point</div>
<div class="line">&gt;&gt;&gt; bisect.bisect([1,3,6], 4)</div>
<div class="line">2  #4 would be at index 2</div>
</div>
<p># Solution logic</p>
<p>1) with itertools.accumulate(probabilities) we make a list that accumulates
probabilities -&gt; P0, P0+P1, P0+P1+P2 etc.
The interval between two such accumulated values will correspond to the probability
of each element (intervals like this (0.0, 0.5), (0.5, 0.833) etc., our
accumulated list [0.0, 0.5, 0.833 ..]</p>
<p>2) We use random.random() to generate a value between 0 and 1.
E.g. 0.6 is generated.</p>
<p>3) We use bisect.bisect() to find the index where that value would be in our
accumulated list. 0.6 in [0.0, 0.5, 0.833 ..] would be at index 2, after 0.5,
so we would return values[2] which is ([3,5,7,11]) 7.</p>
<p>The take away - we choose randomly from &lt;probabilities of the numbers&gt;.</p>
<p>That way we generate one of the n numbers according to the specified probabilities.
(Meaning if the probability of a number ([3,5,7,11]) is high, then the chances
that the randomly generated value (between 0,1) will fall in that range are higher.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">],</span> <span class="mf">0.4</span><span class="p">))</span>  <span class="c1">#1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">],</span> <span class="mf">0.5</span><span class="p">))</span>  <span class="c1">#2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="kn">import</span> <span class="nn">itertools</span><span class="o">,</span> <span class="nn">bisect</span><span class="o">,</span> <span class="nn">random</span>
<span class="k">def</span> <span class="nf">nonuniform_random_number_generation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">):</span>
    <span class="n">prefix_sum_of_probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">probabilities</span><span class="p">))</span>
    <span class="n">interval_idx</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">prefix_sum_of_probabilities</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">interval_idx</span><span class="p">]</span>

<span class="c1"># my rewrite</span>
<span class="k">def</span> <span class="nf">non_uniform_random_num</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_left</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">non_uniform_random_num</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"># My note (off by 1 topic)</div>
<div class="line">for accumulated sum of probabilities, e.g. [0.5, 0.6, 0.8, 1.0],</div>
<div class="line">it seems we will never get the last value in array a, because random will not generate</div>
<div class="line">num above 1.0, but its OK. Last value is at index 3, random()= e.g. 0.9</div>
<div class="line">gives bisect_left() index 3. So we will get the last num.</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s see what&#39;s going on. Adding print calls.</span>
<span class="k">def</span> <span class="nf">nonuniform_random_number_generation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">):</span>
    <span class="n">prefix_sum_of_probabilities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">probabilities</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prefix_sum_of_probabilities</span><span class="p">)</span>
    <span class="n">interval_idx</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">prefix_sum_of_probabilities</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">interval_idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">interval_idx</span><span class="p">]</span>

<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
<span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="o">/</span><span class="mi">18</span><span class="p">,</span> <span class="mi">6</span><span class="o">/</span><span class="mi">18</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">18</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">18</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nonuniform_random_number_generation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">))</span>
<span class="c1"># OUT</span>
<span class="c1"># [0.5, 0.8333333333333333, 0.9444444444444444, 1.0]  #yeah, starts from non-zero</span>
<span class="c1"># 1 #index</span>
<span class="c1"># 5</span>
</pre></div>
</div>
<p>Time O(n) which is time to create the array of intervals.
Space O(n).</p>
</section>
<section id="lc-36-valid-sudoku">
<h2>54. (LC 36) Valid Sudoku<a class="headerlink" href="#lc-36-valid-sudoku" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://leetcode.com/problems/valid-sudoku/">36. Valid Sudoku</a> (Medium)</p>
<p><strong>Version 1.</strong> If you are given a solved, completely filled, Sudoku.</p>
<p># Logic.
We check that no row, column, or 3x3 2D subarray contains duplicates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">def</span> <span class="nf">sudoku_ok</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span> <span class="ow">and</span> <span class="nb">sum</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">line</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">check_sudoku</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
    <span class="n">bad_rows</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">sudoku_ok</span><span class="p">(</span><span class="n">row</span><span class="p">)]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">grid</span><span class="p">))</span>
    <span class="n">bad_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">grid</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">sudoku_ok</span><span class="p">(</span><span class="n">col</span><span class="p">)]</span>
    <span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">square</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">square</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">square</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
    <span class="n">bad_squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">square</span> <span class="k">for</span> <span class="n">square</span> <span class="ow">in</span> <span class="n">squares</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">sudoku_ok</span><span class="p">(</span><span class="n">square</span><span class="p">)]</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="p">(</span><span class="n">bad_rows</span> <span class="ow">or</span> <span class="n">bad_cols</span> <span class="ow">or</span> <span class="n">bad_squares</span><span class="p">)</span>

<span class="n">sudoku</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>  <span class="c1"># &lt;-- not valid sudoku, two 8s</span>
        <span class="p">]</span>

<span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">check_sudoku</span><span class="p">(</span><span class="n">sudoku</span><span class="p">))</span> <span class="c1">#False</span>
<span class="nb">print</span><span class="p">(</span><span class="n">check_sudoku</span><span class="p">(</span><span class="n">board</span><span class="p">))</span>  <span class="c1">#True</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"># <em>Explained.</em></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">grid</span> <span class="pre">=</span> <span class="pre">list(zip(*grid))</span></code></div>
<div class="line">Matrix transpose. To make columns. E.g.:</div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span>
<span class="go">[(1, 10, 5), (2, 20, 7), (3, 30, 6)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Making 3x3 sub-grids.</div>
<div class="line">Iterate indices with step 3, i.e. 0,3,6. For both rows and columns.</div>
</div>
<div class="line-block">
<div class="line">square = list(itertools.chain(row[j:j+3] for row in grid[i:i+3]))</div>
<div class="line">square = [n for i in square for n in i]</div>
<div class="line">chain(‘ABC’, ‘DEF’) –&gt; A B C D E F</div>
<div class="line">It really produces tuples [(1,3,5), (5,3,8), (5,9,7)].</div>
<div class="line">So with the second line we flatten into a list.</div>
<div class="line">[n for i in square for n in i] - i.e. for tuple in square, for number in tuple,</div>
<div class="line">i.e. for each number in tuple in square.</div>
</div>
<p><strong>Version 2.</strong> Check for validity a partially filled board (0 value for blank entries).
[<a class="reference internal" href="../acknowledgements.html#ref-label"><span class="std std-ref">10</span></a>]</p>
<p># <em>Explained.</em>
First of all - do not over complicate.</p>
<p>All that the task asks is to check that each row, column and 3x3 cube is valid,
i.e. all values in each of these are numbers 1-9 without duplicates.
So for a row=[1,2,3,4,5,6,’.’,’.’,9] - all we need to check is if all the VISIBLE
filled in values satisfy the rules. NOT if the blank spaces can “potentially” cause
duplicates (when rows, columns, cubes meet).
So you evaluate the board as of its state “right now”.</p>
<ul class="simple">
<li><p>How we will identify the 3x3 cubes</p></li>
</ul>
<div class="line-block">
<div class="line">We will give each cube an index. The coordinates would then be:</div>
<div class="line-block">
<div class="line">0 1 2</div>
</div>
<div class="line">0</div>
<div class="line">1</div>
<div class="line">2</div>
<div class="line">Leftmost cube is at [0, 0], last most is at [2,2].</div>
<div class="line">How do we get these indices, we take the index of a cell, and //3.</div>
<div class="line">E.g. cell at [8, 8] is in [8//3, 8//3], i.e. in cube [2,2].</div>
</div>
<ul class="simple">
<li><p>Big O</p></li>
</ul>
<p>O(9**2) both time and space, because we iterate through each col, row and also store
the values in hash sets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="k">class</span> <span class="nc">Solution</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">isValidSudoku</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
        <span class="n">squares</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>  <span class="c1"># key is a tuple= (r /3, c /3)</span>

        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">[</span><span class="n">r</span><span class="p">]</span>
                    <span class="ow">or</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                    <span class="ow">or</span> <span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="ow">in</span> <span class="n">squares</span><span class="p">[(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">c</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)]</span>
                <span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="n">cols</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>
                <span class="n">rows</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>
                <span class="n">squares</span><span class="p">[(</span><span class="n">r</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">c</span> <span class="o">//</span> <span class="mi">3</span><span class="p">)]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">board</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">])</span>

        <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<ul class="simple">
<li><p>collections.defaultdict(set)</p></li>
</ul>
<p>We will use hash sets.
So the lines like this of our code:
<code class="docutils literal notranslate"><span class="pre">cols[c].add(board[r][c])</span></code> Will do stuff like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">set</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span>
<span class="go">defaultdict(&lt;class &#39;set&#39;&gt;, {5: {30}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span>
<span class="go">defaultdict(&lt;class &#39;set&#39;&gt;, {5: {30, 31}})  #Yes, sets have {}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">squares[(r</span> <span class="pre">//</span> <span class="pre">3,</span> <span class="pre">c</span> <span class="pre">//</span> <span class="pre">3)].add(board[r][c])</span></code></p></li>
</ul>
<p>What this means is that the key for the ‘squares’ hash set is a tuple.
So it does this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">D</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span>
<span class="go">defaultdict(&lt;class &#39;set&#39;&gt;, {5: {30, 31}, (1, 1): {8}})  &lt;=== adds (1, 1): {8}</span>
</pre></div>
</div>
</section>
<section id="lc-118-compute-rows-in-pascal-s-triangle">
<h2>55. (LC 118) Compute rows in Pascal’s triangle<a class="headerlink" href="#lc-118-compute-rows-in-pascal-s-triangle" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://leetcode.com/problems/pascals-triangle/">118. Pascal’s Triangle</a> (Easy)</p>
<p>Example of the first 5 rows in Pascal’s triangle:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualization</span>
<span class="c1">#       [1]</span>
<span class="c1">#      [1, 1]</span>
<span class="c1">#     [1, 2, 1]</span>
<span class="c1">#   [1, 3, 3, 1]</span>
<span class="c1"># [1, 4, 6, 4, 1]</span>
</pre></div>
</div>
<p>Each row has one more entry than the previous one.
Each entry is the sum of adjacent numbers above.</p>
<p>Write a program which takes as input a nonnegative integer n and returns the first
n rows of Pascal’s triangle.
Hint: Write the given fact as an equation.</p>
<div class="line-block">
<div class="line">Key points:</div>
<div class="line">-Initiate the triangle with all 1s</div>
<div class="line">[[1], [1, 1], [1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1, 1]]</div>
<div class="line">-2 loops (in range(2,n), in range(1,i))</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### Solution</span>
<span class="n">Space</span> <span class="ow">and</span> <span class="n">time</span> <span class="n">O</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_pascal_triangle</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="nb">print</span><span class="p">(</span><span class="n">generate_pascal_triangle</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="c1">### Less magic version, V1</span>
<span class="k">def</span> <span class="nf">pascal_triangle</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">pt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>  <span class="c1"># i because 3 items in 3rd row, 4 items in 4th row etc</span>
            <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">pt</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
            <span class="c1"># Don&#39;t be tempted to do [j+1] !!</span>
            <span class="c1"># item above j to the right is not j+1, it is j, because 1 less item above</span>
    <span class="k">return</span> <span class="n">pt</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1">#here just returning the row n</span>

<span class="c1">### V2</span>
<span class="k">def</span> <span class="nf">pasca</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">tri</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">row</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">tri</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">tri</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">tri</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tri</span>
</pre></div>
</div>
<p>### Explained (the magic version)
<code class="docutils literal notranslate"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">[[1]</span> <span class="pre">*</span> <span class="pre">(i+1)</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(n)]</span></code>
Initializes triangle:
[[1], [1, 1], [1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1, 1]]</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">i is row, j is item in row.</div>
<div class="line">Notably, when i=0, i=1, for j in range(1,0), (1,1)</div>
<div class="line">the loop won’t even go anywhere.</div>
<div class="line">So we will start assignments to the result when row=i=2, j=1,</div>
<div class="line">so we are looking at 2 in [1,2,1].</div>
</div>
<div class="line-block">
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">result[i][j]</span> <span class="pre">=</span> <span class="pre">result[i-1][j-1]</span> <span class="pre">+</span> <span class="pre">result[i-1][j]</span></code></div>
</div>
<div class="line">Sets the entry at row i, index j to the sum of the two entries above.</div>
<div class="line">1,1</div>
<div class="line">1,2,1</div>
<div class="line">result[i-1][j-1] + result[i-1][j]</div>
<div class="line">row above, index j-1 (+) row above, index j</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">### My V3</span>
<span class="k">def</span> <span class="nf">pasca</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ans</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pasca</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="c1">#[[1], [1, 1], [1, 2, 1], [1, 3, 3, 1], [1, 4, 6, 4, 1]]</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="array_1.html" class="btn btn-neutral float-left" title="Array Questions Part 1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="array_3.html" class="btn btn-neutral float-right" title="Array Questions Part 3" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Veronika Kirichenko.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>